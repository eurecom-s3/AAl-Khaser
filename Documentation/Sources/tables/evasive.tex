\begin{landscape}
\begin{scriptsize}
\setlength\LTleft{-1.5cm}
\begin{longtable}{|c|cc|cc|ccc|}
    \toprule
                                                & \textbf{Technique}                                                                                                 & \textbf{Description}                                                                                        & \textbf{Goal TAG}                    & \textbf{Goal Description}                                                                                                                                        & \textbf{Impl. TAG}                & \textbf{Implementation Description}                                                                                                                                                                                                                                                 & \textbf{Example}                                                                                                            \\ \toprule
    \multirow{89}{*}{\rotatebox[origin=c]{91}{Environment Verification}}  & \multirow{13}{*}{\begin{tabular}[c]{@{}c@{}}ROOT\end{tabular}}                      & \multirow{13}{*}{\begin{tabular}[c]{@{}c@{}}Root \\ detection\end{tabular}}                        & \multirow{4}{*}{APPS}       & \multirow{4}{*}{\begin{tabular}[c]{@{}c@{}}Detect if 'root' apps are \\ installed on the device\end{tabular}}                                           & APP\_INFO$^{\dagger}$    & \begin{tabular}[c]{@{}c@{}}Query the package manager with a \\ specific 'root' package name\end{tabular}                                                                                                                                                                   & \begin{tabular}[c]{@{}c@{}}PackageManager.\\ getPackageInfo("magisk")\end{tabular}                                 \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & INST\_APPS$^{\mathsection}$ & \begin{tabular}[c]{@{}c@{}}Retrieve the list of all installed apps \\ on the device\end{tabular}                                                                                                                                                                           & \begin{tabular}[c]{@{}c@{}}PackageManager.\\ getInstalledPackages()\end{tabular}                                   \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & STORAGE$^{\dagger}$      & \begin{tabular}[c]{@{}c@{}}Try to access to the external storage \\ of other 'root' apps\end{tabular}                                                                                                                                                                      &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\dagger}$          & \begin{tabular}[c]{@{}c@{}}Execute command to find/execute \\ the 'root' apps\end{tabular}                                                                                                                                                                                 & popen("magisk")                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{SU}         & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Check the presence of the \\ 'su' binary\end{tabular}}                                                       & FILE$^{\dagger}$         & Access to well known super-user paths                                                                                                                                                                                                                                      & open("/system/bin/su")                                                                                             \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\dagger}$          & \begin{tabular}[c]{@{}c@{}}Execute command to find/execute\\ the 'su' binary\end{tabular}                                                                                                                                                                                  & popen("which su")                                                                                                  \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{BUSYBOX}    & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Check the presence of the \\ 'busybox' binary\end{tabular}}                                                  & FILE$^{\dagger}$         & Access to well known busybox paths                                                                                                                                                                                                                                         &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\dagger}$          & \begin{tabular}[c]{@{}c@{}}Execute command to find/execute \\ the 'busybox' binary\end{tabular}                                                                                                                                                                            &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{3}{*}{PROPS}      & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Check root-related Android \\ system properties\end{tabular}}                                                & PROP$^{\dagger}$         & Retrieve a specific system property                                                                                                                                                                                                                                        &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\dagger}$          & \begin{tabular}[c]{@{}c@{}}Retrieve a specific system property \\ through command line\end{tabular}                                                                                                                                                                        & \begin{tabular}[c]{@{}c@{}}popen\\ ("getprop ro.build.tags")\end{tabular}                                          \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & FOREACH$^{\mathsection}$    & Retrieve all Android system property                                                                                                                                                                                                                                       & popen("getprop")                                                                                                   \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{RO\_PATHS}  & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Check if some paths that should \\ be only readable is also writable\end{tabular}}                           & FILE$^{\mathsection}$       & \begin{tabular}[c]{@{}c@{}}Check the property of \\ the 'read-only' paths\end{tabular}                                                                                                                                                                                     & faccess("/system/bin")                                                                                             \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\mathsection}$        & Check the mounted partitions                                                                                                                                                                                                                                               & popen("mount")                                                                                                     \\ \cline{2-8} 
                                                & \multirow{16}{*}{\begin{tabular}[c]{@{}c@{}}DEBUG\end{tabular}}                     & \multirow{16}{*}{\begin{tabular}[c]{@{}c@{}}Debugging \\ detection\end{tabular}}                   & \multirow{3}{*}{PROPS}      & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Check debug-related Android \\ system properies\end{tabular}}                                                & PROP$^{\dagger}$         & Retrieve a specific system property                                                                                                                                                                                                                                        & ro.debuggable                                                                                                      \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\dagger}$          & \begin{tabular}[c]{@{}c@{}}Retrieve a specific system property \\ through command line\end{tabular}                                                                                                                                                                        &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & FOREACH$^{\mathsection}$    & Retrieve all Android system property                                                                                                                                                                                                                                       &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{MANIFEST}   & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Check if the app was built \\ with the debugabble flag enable\end{tabular}}                                  & APP\_INFO$^{\mathsection}$  & \begin{tabular}[c]{@{}c@{}}Query the package manager to retrieve\\  the app metadata with \\ the GET\_ATTRIBUTIONS flag\end{tabular}                                                                                                                                       &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & INST\_APPS$^{\mathsection}$ & \begin{tabular}[c]{@{}c@{}}Retrieve the info related to the \\ GET\_ATTRIBUTIONS flag \\ for all installed apps\end{tabular}                                                                                                                                               &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & IS\_CON                     & Check if a debugger is connected                                                                                                                        & API$^{\dagger}$          & \begin{tabular}[c]{@{}c@{}}android.os.Debug.\\ isDebuggerConnected()\end{tabular}                                                                                                                                                                                          &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{JDWP}       & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Check the presence of \\ the JDWP debugger\end{tabular}}                                                     & FILE$^{\mathsection}$       & \begin{tabular}[c]{@{}c@{}}Parse the 'comm' files \\ under the '/proc/self/*' directory\end{tabular}                                                                                                                                                                       & \begin{tabular}[c]{@{}c@{}}open\\ ("proc/self/comm")\end{tabular}                                                  \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\mathsection}$        &                                                                                                                                                                                                                                                                            & \begin{tabular}[c]{@{}c@{}}popen\\ ("cat /proc/self/comm")\end{tabular}                                            \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{3}{*}{PORT}       & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Check if the default debugger \\ port is already taken\end{tabular}}                                         & FILE$^{\mathsection}$       & Parse the /proc/net/tcp file                                                                                                                                                                                                                                               & open("proc/net/tcp")                                                                                               \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\mathsection}$        &                                                                                                                                                                                                                                                                            & \begin{tabular}[c]{@{}c@{}}popen\\ ("cat /proc/net/tcp")\end{tabular}                                              \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & SOCKET$^{\dagger}$       & \begin{tabular}[c]{@{}c@{}}Connect with a socket to the \\ default debugger port\end{tabular}                                                                                                                                                                              & \begin{tabular}[c]{@{}c@{}}socket\\ ('127.0.0.1', 23946)\end{tabular}                                              \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{TRACERPID}  & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Check for the presence of a \\ tracer PID\end{tabular}}                                                      & FILE$^{\mathsection}$       & \begin{tabular}[c]{@{}c@{}}Parse the status file of the current \\ process or the tasks of the process\end{tabular}                                                                                                                                                        &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\mathsection}$        &                                                                                                                                                                                                                                                                            &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{3}{*}{TIME}       & \multirow{3}{*}{Time checks}                                                                                                                            & API$^{\mathsection}$        & \begin{tabular}[c]{@{}c@{}}Check the elapsed time in \\ Java or C/C++ code\end{tabular}                                                                                                                                                                                    & \begin{tabular}[c]{@{}c@{}}SystemClock.\\ elapsedRealtime()\end{tabular}                                           \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & FILE$^{\mathsection}$       & \begin{tabular}[c]{@{}c@{}}Parse the '/proc/utime' to retrive \\ the elapsed time\end{tabular}                                                                                                                                                                             &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\mathsection}$        &                                                                                                                                                                                                                                                                            &                                                                                                                    \\ \cline{2-8} 
                                                & \multirow{13}{*}{\begin{tabular}[c]{@{}c@{}}HOOK\end{tabular}}                       & \multirow{13}{*}{\begin{tabular}[c]{@{}c@{}}Hook \\ detection\end{tabular}}                        & \multirow{4}{*}{APPS}       & \multirow{4}{*}{\begin{tabular}[c]{@{}c@{}}Detect if  'hook' apps are installed\\  on the device\end{tabular}}                                          & APP\_INFO$^{\dagger}$    & \begin{tabular}[c]{@{}c@{}}Query the package manager with a \\ specific 'hook' package name\end{tabular}                                                                                                                                                                   & \begin{tabular}[c]{@{}c@{}}PackageManager.\\ getPackageInfo("xposed")\end{tabular}                                 \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & INST\_APPS$^{\mathsection}$ & \begin{tabular}[c]{@{}c@{}}Retrieve the list of all installed \\ apps on the device\end{tabular}                                                                                                                                                                           &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & STORAGE$^{\dagger}$      & \begin{tabular}[c]{@{}c@{}}Try to access to the external storage \\ of other 'hook' apps\end{tabular}                                                                                                                                                                      &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\dagger}$          & \begin{tabular}[c]{@{}c@{}}Execute command to find/execute\\ the 'hook' apps\end{tabular}                                                                                                                                                                                  & \begin{tabular}[c]{@{}c@{}}popen\\ ("find . -name *xposed*")\end{tabular}                                          \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{4}{*}{PROC\_ART}  & \multirow{4}{*}{\begin{tabular}[c]{@{}c@{}}Detect artifacts in the process \\ memory mapping\end{tabular}}                                              & MAPS$^{\mathsection}$       & Parse the '/proc/self/maps' file                                                                                                                                                                                                                                           &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & NF$^{\mathsection}$         & \begin{tabular}[c]{@{}c@{}}Inspect the memory mapping of the \\ process through C/C++ functions\end{tabular}                                                                                                                                                               &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\mathsection}$        &                                                                                                                                                                                                                                                                            & popen("ps")                                                                                                        \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & API$^{\mathsection}$        & \begin{tabular}[c]{@{}c@{}}Check high-level process info \\ by quering the Android APIs\end{tabular}                                                                                                                                                                       & \begin{tabular}[c]{@{}c@{}}Application.\\ getProcessName()\end{tabular}                                            \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & STACKTRACE                  & \begin{tabular}[c]{@{}c@{}}Retrieve and parse the stacktrace \\ to detect call graph artifacts\end{tabular}                                             & API$^{\mathsection}$        &                                                                                                                                                                                                                                                                            & \begin{tabular}[c]{@{}c@{}}Thread.\\ getStackTrace()\end{tabular}                                                  \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{3}{*}{FRIDA}      & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Frida-specific controls \\ (not contained in \\ previous checks)\end{tabular}}                               & FILE$^{\mathsection}$       & \begin{tabular}[c]{@{}c@{}}Check the content of the \\ '/proc/self/fs/*' files\end{tabular}                                                                                                                                                                                &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\mathsection}$        &                                                                                                                                                                                                                                                                            &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & SOCKET$^{\dagger}$       & \begin{tabular}[c]{@{}c@{}}Connect to well known ip/port \\ of the frameworks\end{tabular}                                                                                                                                                                                 & \begin{tabular}[c]{@{}c@{}}socket\\ ("127.0.0.1", 27042)\end{tabular}                                              \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & CLASS                       & \begin{tabular}[c]{@{}c@{}}Detect if the target app retrives \\ well known framework classes\end{tabular}                                               & API$^{\dagger}$          &                                                                                                                                                                                                                                                                            & de.robv.android.*                                                                                                  \\ \cline{2-8} 
                                                & \multirow{16}{*}{\begin{tabular}[c]{@{}c@{}}EMU\end{tabular}}                    & \multirow{16}{*}{\begin{tabular}[c]{@{}c@{}}Emulator \\ detection\end{tabular}}                    & \multirow{3}{*}{PROPS}      & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Check emulator-related \\ Android system properties\end{tabular}}                                            & PROP$^{\dagger}$         & Access to a specific system property                                                                                                                                                                                                                                       &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\dagger}$          & \begin{tabular}[c]{@{}c@{}}Retrieve a specific system property \\ through command line\end{tabular}                                                                                                                                                                        &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & FOREACH$^{\mathsection}$    & Retrieve all Android system property                                                                                                                                                                                                                                       &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{ADB}        & \multirow{2}{*}{Check if the adb is emulated}                                                                                                           & FILE$^{\mathsection}$       & \begin{tabular}[c]{@{}c@{}}Check the content of the \\ '/proc/net/tcp' file\end{tabular}                                                                                                                                                                                   &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\mathsection}$        &                                                                                                                                                                                                                                                                            &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & SENSOR                      & \begin{tabular}[c]{@{}c@{}}Check if sensors' values are not \\ related to real behavior\end{tabular}                                                    & API$^{\mathsection}$        & \begin{tabular}[c]{@{}c@{}}Register a listener to \\ collect sensors' data\end{tabular}                                                                                                                                                                                    & gyroscope                                                                                                          \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{3}{*}{SYSTEM}     & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Check System related properties \\ (e.g., Device ID, Subscriber ID)\end{tabular}}                            & API$^{\dagger}$          &                                                                                                                                                                                                                                                                            & \begin{tabular}[c]{@{}c@{}}TelephonyManager.\\ getLine1Number()\end{tabular}                                       \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & STATS$^{\mathsection}$      & Get (file-)system stats                                                                                                                                                                                                                                                    & ustat                                                                                                              \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & LOGCAT$^{\mathsection}$      & Exploit \textit{logcat} to retrieve system information                                                                                                                                                                                                                                                    &                                                                                                               \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{KNOWN\_EMU} & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Check artifact of well \\ known emulators' artifacts\end{tabular}}                                           & FILE$^{\dagger}$         & Check the presence of the file                                                                                                                                                                                                                                             & \begin{tabular}[c]{@{}c@{}}access\\ ("/dev/socket/genyd")\end{tabular}                                             \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\dagger}$          &                                                                                                                                                                                                                                                                            & \begin{tabular}[c]{@{}c@{}}popen\\ ("ls /init.vbox86.rc")\end{tabular}                                             \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{4}{*}{QEMU}       & \multirow{4}{*}{Check QEMU artifacts}                                                                                                                   & FILE$^{\dagger}$         & Check the presence of a file                                                                                                                                                                                                                                               & \begin{tabular}[c]{@{}c@{}}open\\ ("/dev/qemu\_pipe")\end{tabular}                                                 \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & PROP$^{\dagger}$         & \begin{tabular}[c]{@{}c@{}}Access to QEMU-specific \\ system properties\end{tabular}                                                                                                                                                                                       &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & PROC$^{\mathsection}$       & Check hardware informations                                                                                                                                                                                                                                                & /proc/cpuinfo                                                                                                      \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\mathsection}$        &                                                                                                                                                                                                                                                                            &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{BEHAVIOR}   & \multirow{2}{*}{Check (emulated) device features}                                                                                                       & BATTERY$^{\mathsection}$    & \begin{tabular}[c]{@{}c@{}}Check the battery status through \\ API or broadcast receivers\end{tabular}                                                                                                                                                                     & \begin{tabular}[c]{@{}c@{}}New receiver for:\\ BATTERY\_CHANGED\end{tabular}                                       \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & USER\_PROF$^{\mathsection}$ &                                                                                                                                                                                                                                                                            &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & HARDWARE$^{\mathsection}$ &    \begin{tabular}[c]{@{}c@{}}Check hardware-related discrepancy.\\For instance, graphical low video frame rate\end{tabular}                                                                                                                                                                  &                                                                                                                    \\ \cline{2-8} 
                                                & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}MEMTMP\end{tabular}}    & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Memory \\ integrity \\ verification\end{tabular}}       & MEM2DISK                    & \begin{tabular}[c]{@{}c@{}}Check the content of a file \\ w.r.t. the one loaded in memory\end{tabular}                                                  & FILE$^{\mathsection}$       & \begin{tabular}[c]{@{}c@{}}Open libraries that are already mapped \\ into the memory of the process\end{tabular}                                                                                                                                                           &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & PLT                         & Check for PLT modifications                                                                                                                             & ---                      & It is not possible to detect                                                                                                                                                                                                                                               &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & INLINE                      & \begin{tabular}[c]{@{}c@{}}Check for inline breakpoints \\ or trampolines\end{tabular}                                                                  & ---                      & It is not possible to detect                                                                                                                                                                                                                                               &                                                                                                                    \\ \cline{2-8} 
                                                & \multirow{13}{*}{\begin{tabular}[c]{@{}c@{}}VIRT\end{tabular}} & \multirow{12}{*}{\begin{tabular}[c]{@{}c@{}}App-level \\ virtualization \\ detection\end{tabular}} & \multirow{3}{*}{FAKE\_COMP} & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Check components' name \\ w.r.t. the ones in the Manifest\end{tabular}}                                      & API$^{\mathsection}$        & \begin{tabular}[c]{@{}c@{}}Retrieve the list of registered/running \\ components of the app\end{tabular}                                                                                                                                                                   &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & APP\_INFO$^{\mathsection}$  & \begin{tabular}[c]{@{}c@{}}Query the package manager to retrieve \\ the metadata of the app with \\ one of the following flags: \\ GET\_ACTIVITIES, \\ GET\_ATTRIBUTIONS, \\ GET\_RECEIVERS, GET\_SERVICES, \\ GET\_PROVIDERS, \\ GET\_SHARED\_LIBRARY\_FILES\end{tabular} &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & INST\_APPS$^{\mathsection}$ & \begin{tabular}[c]{@{}c@{}}Retrieve the info for all installed apps \\ with one of the following flags: \\ GET\_ACTIVITIES,\\ GET\_ATTRIBUTIONS,\\ GET\_RECEIVERS, \\ GET\_SERVICES, GET\_PROVIDERS, \\ GET\_SHARED\_LIBRARY\_FILES\end{tabular}                           &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{3}{*}{APP}        & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Check if the app is really \\ installed on the device\end{tabular}}                                          & APP\_INFO$^{\mathsection}$  & \begin{tabular}[c]{@{}c@{}}Query the package manager to retrieve \\ the metadata of the app itself\end{tabular}                                                                                                                                                            &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & INST\_APPS$^{\mathsection}$ & Retrieve the info for all installed apps                                                                                                                                                                                                                                   &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & NATIVE$^{\mathsection}$ & Retrieve the info of native libraries                                                                                                                                                                                                                                    &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{PROC}       & \multirow{2}{*}{Check the app's processes}                                                                                                              & CMD$^{\mathsection}$        &                                                                                                                                                                                                                                                                            & popen("ps")                                                                                                        \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & API$^{\mathsection}$        & \begin{tabular}[c]{@{}c@{}}Retrieve the list of running components \\ of the app and their metadata\end{tabular}                                                                                                                                                           & \begin{tabular}[c]{@{}c@{}}Application.\\ getProcessName()\end{tabular}                                            \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{3}{*}{UND\_PERMS} & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Check if the app has or check for \\ permissions that are not declared \\ in the Manifest file\end{tabular}} & API$^{\dagger}$          &                                                                                                                                                                                                                                                                            & \begin{tabular}[c]{@{}c@{}}Context.\\ checkPermission\\ (\textless{}no\_manifest\_perm\textgreater{})\end{tabular} \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & APP\_INFO$^{\mathsection}$  & \begin{tabular}[c]{@{}c@{}}Query the package manager to retrieve \\ the metadata of the app with \\ the GET\_PERMISSIONS, or \\ GET\_URI\_PERMISSIONS\_PATTERNS \\ flag\end{tabular}                                                                                       &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & INST\_APPS$^{\mathsection}$ & \begin{tabular}[c]{@{}c@{}}Retrieve the info for all installed apps with \\ GET\_PERMISSIONS, or\\ GET\_URI\_PERMISSIONS\_PATTERNS\\ flag\end{tabular}                                                                                                                     &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{APP\_DIR}   & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Check the installation path and \\ other app's private folders\end{tabular}}                                 & APP\_INFO$^{\mathsection}$  & \begin{tabular}[c]{@{}c@{}}Query the package manager to retrieve\\ the metadata of the app \\ with the GET\_METADATA flag\end{tabular}                                                                                                                                     &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & INST\_APPS$^{\mathsection}$ & \begin{tabular}[c]{@{}c@{}}Retrieve the info for all installed apps \\ with the GET\_METADATA flag\end{tabular}                                                                                                                                                            &                                                                                                                    \\ \cline{2-8} 
                                                & \multirow{16}{*}{\begin{tabular}[c]{@{}c@{}}NET\end{tabular}}                     & \multirow{15}{*}{\begin{tabular}[c]{@{}c@{}}Network \\ detection\end{tabular}}                     & ADB                         & Check if the adb is emulated                                                                                                                            & SOCKET$^{\dagger}$       & Connect to the default adb port                                                                                                                                                                                                                                            & \begin{tabular}[c]{@{}c@{}}socket\\ ("127.0.0.1", 5555)\end{tabular}                                               \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{5}{*}{VPN}        & \multirow{5}{*}{Check the presence of a VPN}                                                                                                            & API$^{\dagger}$          &                                                                                                                                                                                                                                                                            & \begin{tabular}[c]{@{}c@{}}NetworkCapabilities.\\ hasTransport()\end{tabular}                                      \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & APP\_INFO$^{\dagger}$    & \begin{tabular}[c]{@{}c@{}}Query the package manager to retrieve \\ the metadata of well known VPN apps\end{tabular}                                                                                                                                                       &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & INST\_APPS$^{\mathsection}$ & Retrieve the info for all installed apps                                                                                                                                                                                                                                   &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & STORAGE$^{\dagger}$      & \begin{tabular}[c]{@{}c@{}}Try to access to the external storage \\ of other VPN apps\end{tabular}                                                                                                                                                                         &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\dagger}$          & \begin{tabular}[c]{@{}c@{}}Execute command to find/execute \\ the VPN apps\end{tabular}                                                                                                                                                                                    &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{4}{*}{INTERFACE}  & \multirow{4}{*}{\begin{tabular}[c]{@{}c@{}}Check the metadata of the \\ network interfaces\end{tabular}}                                                & NF$^{\mathsection}$         &                                                                                                                                                                                                                                                                            & getifaddrs()                                                                                                       \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & FILE$^{\mathsection}$       & \begin{tabular}[c]{@{}c@{}}Check the content of \\ '/proc/sys/net/ipv(4|6)' and '/sys/class/net'\end{tabular}                                                                                                                                                              &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\mathsection}$        & Command line commnds                                                                                                                                                                                                                                                       & popen("ifconfig")                                                                                                  \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & API$^{\mathsection}$        &                                                                                                                                                                                                                                                                            & \begin{tabular}[c]{@{}c@{}}ConnectivityManager.\\ getNetworkInfo()\end{tabular}                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & FAKEIP                      & \begin{tabular}[c]{@{}c@{}}Check if the current IP \\ is not real\end{tabular}                                                                          & CMD$^{\mathsection}$        &                                                                                                                                                                                                                                                                            & /system/bin/netcfg                                                                                                 \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & KNOWNIP                     & \begin{tabular}[c]{@{}c@{}}Check if the current IP \\ is well known\end{tabular}                                                                        & SOCKET$^{\dagger}$       &                                                                                                                                                                                                                                                                            & maxmind.com                                                                                                        \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & ADB                     & \begin{tabular}[c]{@{}c@{}}Check if the standard adb \\ port is already used\end{tabular}                                                                        & SOCKET$^{\dagger}$       &                                                                                                                                                                                                                                                                            & maxmind.com                                                                                                        \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & SSL\_PINNING                & \begin{tabular}[c]{@{}c@{}}Check if the app \\ uses ssl pinning\end{tabular}                                                                            & API$^{\mathsection}$        & \begin{tabular}[c]{@{}c@{}}The app uses the SSL Context \\ to perform a network request\end{tabular}                                                                                                                                                                       &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{LISTENER}   & \multirow{2}{*}{Monitor changes for network}                                                                                                            & API$^{\mathsection}$        & \begin{tabular}[c]{@{}c@{}}Register a new listener though \\ the Android API\end{tabular}                                                                                                                                                                                  & \begin{tabular}[c]{@{}c@{}}ConnectivityManager.\\ listenForNetwork()\end{tabular}                                  \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & BR$^{\mathsection}$         & \begin{tabular}[c]{@{}c@{}}Register a broadcast receiver \\ at runtime for:\\ 'CONNECTIVITY\_CHANGE', \\ 'WIFI\_STATE\_CHANGED', and \\ 'AIRPLANE\_MODE'\end{tabular}                                                                                                      &                                                                                                                    \\ \hline
    \multirow{5}{*}{\rotatebox[origin=c]{90}{APK Tampering Verification}} & \multirow{4}{*}{\begin{tabular}[c]{@{}c@{}}SIGNATURE\end{tabular}}                 & \multirow{4}{*}{\begin{tabular}[c]{@{}c@{}}Signature \\ check\end{tabular}}                        & \multirow{2}{*}{ZIP}        & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Read the certificate files \\ in the APK\end{tabular}}                                                       & FILE$^{\mathsection}$       & Access to the APK                                                                                                                                                                                                                                                          & \begin{tabular}[c]{@{}c@{}}ZipFile\\ ("/path/to/base.apk")\end{tabular}                                            \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & CMD$^{\mathsection}$        &                                                                                                                                                                                                                                                                            & \begin{tabular}[c]{@{}c@{}}popen\\ ("unzip base.apk")\end{tabular}                                                 \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & \multirow{2}{*}{APP}        & \multirow{2}{*}{}                                                                                                                                       & APP\_INFO$^{\mathsection}$  & \begin{tabular}[c]{@{}c@{}}Query the package manager to retrieve \\ the metadata of the app with \\ GET\_SIGNATURES, or \\ GET\_SIGNING\_CERTIFICATES flags\end{tabular}                                                                                                   &                                                                                                                    \\ \cline{6-8} 
                                                &                                                                                                           &                                                                                                    &                             &                                                                                                                                                         & INST\_APPS$^{\mathsection}$ & \begin{tabular}[c]{@{}c@{}}Retrieve the info for all \\ installed apps with the \\ GET\_SIGNATURES, or\\ GET\_SIGNING\_CERTIFICATES \\ flags\end{tabular}                                                                                                                  &                                                                                                                    \\ \cline{2-8} 
                                                & \begin{tabular}[c]{@{}c@{}}INSTALL\end{tabular}                               & \begin{tabular}[c]{@{}c@{}}Installer \\ Verification\end{tabular}                                  &     SOURCE                        &                                                                                                                                                         & API$^{\dagger}$          &                                                                                                                                                                                                                                                                            & \begin{tabular}[c]{@{}c@{}}PackageManager.\\ getInstallSourceInfo()\end{tabular}                                   \\ \hline
    \multirow{5}{*}{\rotatebox[origin=c]{90}{High-level Verification}}    & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}GOOGLE\end{tabular}}          & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}SafetyNet \& \\ Integrity API \\ \end{tabular}}          & SN                          & SafetyNet checks                                                                                                                                        & BINDER$^{\dagger}$       & \begin{tabular}[c]{@{}c@{}}Check the binder methods \\ for the SafetyNet requests\end{tabular}                                                                                                                                                                             &                                                                                                                    \\ \cline{4-8} 
                                                &                                                                                                           &                                                                                                    & IA                          & Integrity API                                                                                                                                           & API$^{\dagger}$          &                                                                                                                                                                                                                                                                            &                                                                                                                    \\ \cline{2-8} 
                                                & \begin{tabular}[c]{@{}c@{}}HUMAN\end{tabular}                   & \begin{tabular}[c]{@{}c@{}}\\Interaction \\ with \\ a human \\ being\end{tabular}                    & ---                         &                                                                                                                                                         & ---                      & It is not possible to detect                                                                                                                                                                                                                                               &                                                                                                                    \\

                                                \\ \\ \bottomrule

% \captionsetup{justification=centering}
\caption{List of evasive techniques. \\
  $\dagger$: Direct Evasive Technique (DET) \\
  $^{\mathsection}$: Indirect Evasive Technique (IET)
}
\label{tab:all_evasive}

\end{longtable}
\end{scriptsize}
\end{landscape}